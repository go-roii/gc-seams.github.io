"use strict";(self.webpackChunkGCSEAMS=self.webpackChunkGCSEAMS||[]).push([[69],{9069:(ge,h,c)=>{c.r(h),c.d(h,{EventsModule:()=>pe});var r=c(9808),g=c(8118),e=c(1223),d=c(5861),E=c(7579),v=c(2033),l=c(555),m=c(968);let u=(()=>{class n{constructor(t,s){this.userService=t,this.dataService=s,this.detailsPaneInfoChange=new E.x}get dpEventStartDate(){const t=this.eventInfo.event_start_date.split("[")[0].toString();return new Date(t)}get dpEventEndDate(){const t=this.eventInfo.event_end_date.split("[")[0].toString();return new Date(t)}get dpCurrentEventProgress(){let t=new Date;if(t>=this.dpEventEndDate)return 100;if(t>=this.dpEventStartDate){const s=(this.dpEventEndDate.getTime()-this.dpEventStartDate.getTime())/6e4;return Math.trunc(Math.round((t.getTime()-this.dpEventStartDate.getTime())/6e4)/s*100)}return 0}initializeDetailsPane(t){this.detailsPane=t,this.bsDetailsPane=new bootstrap.Offcanvas(this.detailsPane),this.detailsPane.addEventListener("hidden.bs.offcanvas",()=>{this.detailsPaneInfoChange.next({isDetailsPaneShown:!1,selectedEventCard:void 0,dpEventID:0,dpEventUUID:"",dpEventPosterLink:"",dpEventTitle:"",dpEventStartDate:void 0,dpEventEndDate:void 0,dpCurrentEventProgress:0,dpEventDescription:"",dpEventInvitedDepartments:[],dpEventSpeakers:[]})})}showDetailsPane(t){var s=this;const o=new v.K;o.EndPoint="event/"+t,o.requestType=5,o.authToken=this.userService.HttpOptions,this.dataService.httpRequest(o).subscribe(function(){var a=(0,d.Z)(function*(p){s.eventInfo=p,s.detailsPaneInfoChange.next({isDetailsPaneShown:!0,selectedEventCard:p.event_id,dpEventUUID:t,dpEventPosterLink:p.event_poster_link,dpEventTitle:p.event_title,dpEventStartDate:s.dpEventStartDate,dpEventEndDate:s.dpEventEndDate,dpCurrentEventProgress:s.dpCurrentEventProgress,dpEventDescription:p.event_description,dpEventInvitedDepartments:p.departments,dpEventSpeakers:p.speakers}),s.bsDetailsPane.show()});return function(p){return a.apply(this,arguments)}}())}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.K),e.LFG(m.D))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var C=c(7899);const y=["detailsPane"];function x(n,i){1&n&&(e.O4$(),e.TgZ(0,"svg",27),e._UZ(1,"rect",28),e.qZA())}function P(n,i){if(1&n&&e._UZ(0,"img",29),2&n){const t=e.oxw();e.s9C("src",t.dpEventPosterLink,e.LSH)}}function b(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=i.$implicit;e.xp6(2),e.Oqu(t.department_code)}}function T(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=i.$implicit;e.xp6(2),e.Oqu(t.speaker_name)}}const Z=function(n){return{"pe-none":n}},O=function(n){return{"progress-bar-animated progress-bar-striped":n}};let D=(()=>{class n{constructor(t){this.detailsPaneService=t,this.dpEventPosterLink=""}ngOnInit(){}ngAfterViewInit(){this.instantiateDetailsPane(),this.subscribeToDetailsPaneChange()}subscribeToDetailsPaneChange(){this.detailsPaneService.detailsPaneInfoChange.subscribe(t=>{this.isDetailsPaneShown=t.isDetailsPaneShown,this.dpEventUUID=t.dpEventUUID,this.dpEventTitle=t.dpEventTitle,this.dpEventStartDate=t.dpEventStartDate,this.dpEventEndDate=t.dpEventEndDate,this.dpCurrentEventProgress=t.dpCurrentEventProgress,this.dpEventDescription=t.dpEventDescription,this.dpEventSpeakers=t.dpEventSpeakers,this.dpEventPosterLink=t.dpEventPosterLink,this.dpEventInvitedDepartments=t.dpEventInvitedDepartments})}instantiateDetailsPane(){this.detailsPaneService.initializeDetailsPane(this.detailsPane.nativeElement)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-events"]],viewQuery:function(t,s){if(1&t&&e.Gf(y,5),2&t){let o;e.iGM(o=e.CRH())&&(s.detailsPane=o.first)}},decls:51,vars:30,consts:[["id","events-body"],[1,"gs-header"],[1,"tabs","user-select-none"],[1,"nav"],["data-bs-dismiss","offcanvas","data-bs-target","#details-pane",1,"nav-item"],["routerLink","ongoing","routerLinkActive","active",1,"nav-link"],[1,"active-tab-indicator"],["routerLink","upcoming","routerLinkActive","active",1,"nav-link"],["routerLink","past","routerLinkActive","active",1,"nav-link"],["id","details-pane","data-bs-scroll","true","data-bs-backdrop","false","data-bs-keyboard","true","tabindex","-1",1,"offcanvas","offcanvas-end",2,"transition","none"],["detailsPane",""],[1,"offcanvas-header","p-4","pb-0"],["type","button","data-bs-dismiss","offcanvas",1,"btn-close","text-reset"],[1,"offcanvas-body","d-flex","flex-column","p-4"],["id","event-poster","data-bs-toggle","modal","data-bs-target","#viewFullEventPosterModal",1,"user-select-none","mb-4",3,"ngClass"],[1,"upload-event-poster-text","text-center"],["id","event-poster-img","style","aspect-ratio: 3/2;",4,"ngIf","ngIfElse"],["eventPoster",""],["id","dp-event-title",1,"text-break","mb-0"],["id","dp-event-datetime",1,"text-primary"],[1,"progress","mb-3"],["role","progressbar",1,"progress-bar","rounded-pill",3,"ngClass"],["id","dp-event-description"],[4,"ngFor","ngForOf"],[1,"d-grid","mt-auto","p-4"],["type","button",1,"btn","btn-lg","btn-primary","shadow",3,"routerLink"],[3,"eventPosterLink"],["id","event-poster-img",2,"aspect-ratio","3/2"],["width","100%","height","100%","fill","var(--bs-primary)"],["id","event-poster-img",3,"src"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2"),e._uU(3,"My Events"),e.qZA(),e.qZA(),e.TgZ(4,"div",2),e.TgZ(5,"ul",3),e.TgZ(6,"li",4),e.TgZ(7,"a",5),e._uU(8,"Ongoing"),e.qZA(),e._UZ(9,"div",6),e.qZA(),e.TgZ(10,"li",4),e.TgZ(11,"a",7),e._uU(12,"Upcoming"),e.qZA(),e._UZ(13,"div",6),e.qZA(),e.TgZ(14,"li",4),e.TgZ(15,"a",8),e._uU(16,"Past"),e.qZA(),e._UZ(17,"div",6),e.qZA(),e.qZA(),e.qZA(),e._UZ(18,"router-outlet"),e.TgZ(19,"div",9,10),e.TgZ(21,"div",11),e._UZ(22,"button",12),e.qZA(),e.TgZ(23,"div",13),e.TgZ(24,"div",14),e.TgZ(25,"p",15),e._uU(26,"View full event poster"),e.qZA(),e.YNc(27,x,2,0,"svg",16),e.YNc(28,P,1,1,"ng-template",null,17,e.W1O),e.qZA(),e.TgZ(30,"h2",18),e._uU(31),e.qZA(),e.TgZ(32,"p",19),e._uU(33),e.ALo(34,"date"),e.ALo(35,"date"),e.ALo(36,"date"),e.qZA(),e.TgZ(37,"div",20),e._UZ(38,"div",21),e.qZA(),e.TgZ(39,"p",22),e._uU(40),e.qZA(),e.TgZ(41,"h6"),e._uU(42,"Invited Departments"),e.qZA(),e.YNc(43,b,3,1,"ng-container",23),e.TgZ(44,"h6"),e._uU(45,"Speakers"),e.qZA(),e.YNc(46,T,3,1,"ng-container",23),e.qZA(),e.TgZ(47,"div",24),e.TgZ(48,"button",25),e._uU(49,"View Attendance"),e.qZA(),e.qZA(),e.qZA(),e._UZ(50,"app-view-photo-modal",26),e.qZA()),2&t){const o=e.MAs(29);e.Udp("margin-right",s.isDetailsPaneShown?"400px":"0"),e.xp6(24),e.Q6J("ngClass",e.VKq(26,Z,0===s.dpEventPosterLink.length)),e.xp6(3),e.Q6J("ngIf",0===s.dpEventPosterLink.length)("ngIfElse",o),e.xp6(4),e.Oqu(s.dpEventTitle),e.xp6(2),e.lnq("",e.xi3(34,17,s.dpEventStartDate,"mediumDate")," - ",e.xi3(35,20,s.dpEventStartDate,"shortTime")," to ",e.xi3(36,23,s.dpEventEndDate,"shortTime"),""),e.xp6(5),e.Udp("width",s.dpCurrentEventProgress+"%"),e.Q6J("ngClass",e.VKq(28,O,s.dpCurrentEventProgress>0&&s.dpCurrentEventProgress<100)),e.xp6(2),e.Oqu(s.dpEventDescription),e.xp6(3),e.Q6J("ngForOf",s.dpEventInvitedDepartments),e.xp6(3),e.Q6J("ngForOf",s.dpEventSpeakers),e.xp6(2),e.Q6J("routerLink",s.dpEventUUID),e.xp6(2),e.Q6J("eventPosterLink",s.dpEventPosterLink)}},directives:[g.yS,g.Od,g.lC,r.mk,r.O5,r.sg,g.rH,C.m],pipes:[r.uU],styles:['#events-body[_ngcontent-%COMP%]{height:100%;overflow-y:scroll}.tabs[_ngcontent-%COMP%]{background-color:#fff;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none;padding:16px 32px 0}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.tabs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{gap:24px;width:max-content}.tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--bs-gray-600);font-size:16px;padding:4px 6px 8px}.tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:unset;font-weight:500}.tabs[_ngcontent-%COMP%]   .active-tab-indicator[_ngcontent-%COMP%]{display:none;min-height:3px;background-color:var(--bs-primary);border-radius:99px 99px 0 0}.tabs[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%] + .active-tab-indicator[_ngcontent-%COMP%]{display:block}#event-poster[_ngcontent-%COMP%]{flex-shrink:0;position:relative;z-index:100;width:100%;border-radius:12px;overflow:hidden;cursor:pointer}#event-poster[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;transition:.3s cubic-bezier(.6,.05,.28,.91)}#event-poster[_ngcontent-%COMP%]:hover:before{background-color:#00000040}#event-poster[_ngcontent-%COMP%]:hover   .upload-event-poster-text[_ngcontent-%COMP%]{opacity:1}#event-poster-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.upload-event-poster-text[_ngcontent-%COMP%]{color:#fff;opacity:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transition:opacity .3s cubic-bezier(.6,.05,.28,.91)}.progress[_ngcontent-%COMP%]{height:4px;min-height:4px}']}),n})();function w(n,i){1&n&&(e.O4$(),e.TgZ(0,"svg",9),e._UZ(1,"rect",10),e._uU(2,"--\x3e "),e.qZA())}function M(n,i){if(1&n&&e._UZ(0,"img",11),2&n){const t=e.oxw();e.s9C("src",t.eventInfo.event_poster_link,e.LSH)}}const S=function(n){return["/home/events",n]},A=function(n){return{"progress-bar-animated progress-bar-striped":n}};let _=(()=>{class n{constructor(){}ngOnInit(){this.formatDate(),this.getEventProgress()}formatDate(){const t=this.eventInfo.event_start_date.split("[")[0].toString(),s=this.eventInfo.event_end_date.split("[")[0].toString();this.eventStartDate=new Date(t),this.eventEndDate=new Date(s)}getEventProgress(){let t=new Date;if(t>=this.eventEndDate)this.currentEventProgress=100;else if(t>=this.eventStartDate){const s=(this.eventEndDate.getTime()-this.eventStartDate.getTime())/6e4;this.currentEventProgress=Math.trunc(Math.round((t.getTime()-this.eventStartDate.getTime())/6e4)/s*100),console.log("event duration: "+s+"min"),console.log("event progress: "+this.currentEventProgress+"%")}else this.currentEventProgress=0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-event-card-view"]],inputs:{eventInfo:"eventInfo"},decls:15,vars:23,consts:[[1,"card","user-select-none"],[3,"routerLink","click"],["class","card-img-top",4,"ngIf","ngIfElse"],["eventPoster",""],[1,"card-body"],[1,"card-title"],[1,"card-subtitle","mb-3"],[1,"progress"],["role","progressbar",1,"progress-bar","rounded-pill",3,"ngClass"],[1,"card-img-top"],["width","100%","height","100%","fill","var(--bs-primary)"],[1,"card-img-top",3,"src"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"a",1),e.NdJ("click",function(a){return a.stopPropagation}),e.YNc(2,w,3,0,"svg",2),e.YNc(3,M,1,1,"ng-template",null,3,e.W1O),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"h5",5),e._uU(7),e.qZA(),e.TgZ(8,"p",6),e._uU(9),e.ALo(10,"date"),e.ALo(11,"date"),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"div",8),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.MAs(4);e.xp6(1),e.Q6J("routerLink",e.VKq(19,S,s.eventInfo.event_uuid)),e.xp6(1),e.Q6J("ngIf",0===s.eventInfo.event_poster_link.length)("ngIfElse",o),e.xp6(5),e.Oqu(s.eventInfo.event_title),e.xp6(2),e.lnq("",e.xi3(10,10,s.eventStartDate,"mediumDate")," - ",e.xi3(11,13,s.eventStartDate,"shortTime")," to ",e.xi3(12,16,s.eventEndDate,"shortTime"),""),e.xp6(5),e.Udp("width",s.currentEventProgress+"%"),e.Q6J("ngClass",e.VKq(21,A,s.currentEventProgress>0&&s.currentEventProgress<100))}},directives:[g.yS,r.O5,r.mk],pipes:[r.uU],styles:["[_nghost-%COMP%]{--card-aspect-ratio: 16/9}.selected[_nghost-%COMP%]   .card[_ngcontent-%COMP%], .selected   [_nghost-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid var(--bs-primary);box-shadow:0 0 6px rgb(var(--bs-primary-rgb),64%)}.updated[_nghost-%COMP%]   .card[_ngcontent-%COMP%], .updated   [_nghost-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid var(--bs-primary);box-shadow:0 0 6px rgb(var(--bs-primary-rgb),64%)}.card[_ngcontent-%COMP%]{aspect-ratio:var(--card-aspect-ratio)}.card-img-top[_ngcontent-%COMP%]{aspect-ratio:var(--card-aspect-ratio);object-fit:cover;background-color:var(--bs-gray-100)}.card-title[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:1;line-clamp:1;overflow:hidden;-webkit-box-orient:vertical}.card-subtitle[_ngcontent-%COMP%]{color:var(--bs-primary);font-size:14px}.progress[_ngcontent-%COMP%]{height:4px}"]}),n})(),f=(()=>{class n{constructor(){this.emptyMessage={title:"Title",message:"Message"}}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-empty-state"]],inputs:{emptyMessage:"emptyMessage"},decls:4,vars:2,consts:[["id","empty-title",1,"text-center","mb-3"],["id","empty-message",1,"text-muted"]],template:function(t,s){1&t&&(e.TgZ(0,"h2",0),e._uU(1),e.qZA(),e.TgZ(2,"p",1),e._uU(3),e.qZA()),2&t&&(e.xp6(1),e.Oqu(s.emptyMessage.title),e.xp6(2),e.hij(" ",s.emptyMessage.message,"\n"))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}"]}),n})();function U(n,i){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3,"Loading..."),e.qZA(),e.qZA(),e.qZA())}const I=function(n){return{selected:n}};function k(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-event-card-view",9),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).openDetailsPane(a.event_uuid)}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,I,s.selectedEventCard==t.event_uuid))("eventInfo",t)}}function q(n,i){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,k,1,4,"app-event-card-view",8),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.ongoingEvents)}}function F(n,i){if(1&n&&e.YNc(0,q,2,1,"div",6),2&n){const t=e.oxw(),s=e.MAs(4);e.Q6J("ngIf",!t.isFetchingEvents&&t.ongoingEvents.length>0)("ngIfElse",s)}}const Y=function(){return{title:"No events yet...",message:"Click the button at the side navigation bar to create an event"}};function J(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"app-empty-state",10),e.qZA()),2&n&&(e.xp6(1),e.Q6J("emptyMessage",e.DdM(1,Y)))}let Q=(()=>{class n{constructor(t,s,o){this.userService=t,this.dataService=s,this.detailsPaneService=o,this.searchText="",this.ongoingEvents=[],this.isFetchingEvents=!0,this.detailsPaneService.detailsPaneInfoChange.subscribe(a=>{this.selectedEventCard=a.dpEventUUID})}ngOnInit(){this.fetchOngoingEvents()}fetchOngoingEvents(){var t=this;const s=new v.K;s.EndPoint="/events/ongoing",s.requestType=5,s.authToken=this.userService.HttpOptions,this.dataService.httpRequest(s).subscribe(function(){var o=(0,d.Z)(function*(a){t.setOngoingEvents(a),console.log(t.ongoingEvents),t.isFetchingEvents=!1,t.sortEvents()});return function(a){return o.apply(this,arguments)}}(),function(){var o=(0,d.Z)(function*(a){"Unauthorized"==a.statusText?(t.userService.refreshAccessToken(),t.userService.start()):(t.dataService.handleError(a),t.isFetchingEvents=!1)});return function(a){return o.apply(this,arguments)}}())}setOngoingEvents(t){this.ongoingEvents=t}sortEvents(){this.ongoingEvents.sort((t,s)=>new Date(t.event_start_date.split("[")[0]).valueOf()-new Date(s.event_start_date.split("[")[0]).valueOf())}openDetailsPane(t){this.detailsPaneService.showDetailsPane(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.K),e.Y36(m.D),e.Y36(u))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ongoing"]],decls:5,vars:2,consts:[["style","display: flex; align-items: center; justify-content: center; margin: 300px 0;",4,"ngIf","ngIfElse"],["eventList",""],["emptyState",""],[2,"display","flex","align-items","center","justify-content","center","margin","300px 0"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","ongoing-body",4,"ngIf","ngIfElse"],["id","ongoing-body"],[3,"ngClass","eventInfo","click",4,"ngFor","ngForOf"],[3,"ngClass","eventInfo","click"],[3,"emptyMessage"]],template:function(t,s){if(1&t&&(e.YNc(0,U,4,0,"div",0),e.YNc(1,F,1,2,"ng-template",null,1,e.W1O),e.YNc(3,J,2,2,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.isFetchingEvents)("ngIfElse",o)}},directives:[r.O5,r.sg,_,r.mk,f],styles:["#ongoing-body[_ngcontent-%COMP%]{display:none;padding:32px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:24px;margin-top:200px}#ongoing-body[_ngcontent-%COMP%]:not(:empty){display:grid;grid-gap:2rem 1.25rem;gap:2rem 1.25rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}#ongoing-body[_ngcontent-%COMP%]:not(:empty) + .empty-state[_ngcontent-%COMP%]{display:none}"]}),n})();function N(n,i){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3,"Loading..."),e.qZA(),e.qZA(),e.qZA())}const z=function(n){return{selected:n}};function V(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-event-card-view",9),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).openDetailsPane(a.event_uuid)}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,z,s.selectedEventCard==t.event_uuid))("eventInfo",t)}}function j(n,i){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,V,1,4,"app-event-card-view",8),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.pastEvents)}}function K(n,i){if(1&n&&e.YNc(0,j,2,1,"div",6),2&n){const t=e.oxw(),s=e.MAs(4);e.Q6J("ngIf",!t.isFetchingEvents&&t.pastEvents.length>0)("ngIfElse",s)}}const $=function(){return{title:"No events yet...",message:"Click the button at the side navigation bar to create an event"}};function R(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"app-empty-state",10),e.qZA()),2&n&&(e.xp6(1),e.Q6J("emptyMessage",e.DdM(1,$)))}let W=(()=>{class n{constructor(t,s,o){this.userService=t,this.dataService=s,this.detailsPaneService=o,this.searchText="",this.pastEvents=[],this.isFetchingEvents=!0,this.detailsPaneService.detailsPaneInfoChange.subscribe(a=>{this.selectedEventCard=a.dpEventUUID})}ngOnInit(){this.fetchPastEvents()}fetchPastEvents(){var t=this;const s=new v.K;s.EndPoint="/events/past",s.requestType=5,s.authToken=this.userService.HttpOptions,this.dataService.httpRequest(s).subscribe(function(){var o=(0,d.Z)(function*(a){t.setOngoingEvents(a),console.log(t.pastEvents),t.isFetchingEvents=!1,t.sortEvents()});return function(a){return o.apply(this,arguments)}}(),function(){var o=(0,d.Z)(function*(a){"Unauthorized"==a.statusText?(t.userService.refreshAccessToken(),t.userService.start()):(t.dataService.handleError(a),t.isFetchingEvents=!1)});return function(a){return o.apply(this,arguments)}}())}setOngoingEvents(t){this.pastEvents=t}sortEvents(){this.pastEvents.sort((t,s)=>new Date(s.event_start_date.split("[")[0]).valueOf()-new Date(t.event_start_date.split("[")[0]).valueOf())}openDetailsPane(t){this.detailsPaneService.showDetailsPane(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.K),e.Y36(m.D),e.Y36(u))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-past"]],decls:5,vars:2,consts:[["style","display: flex; align-items: center; justify-content: center; margin: 300px 0;",4,"ngIf","ngIfElse"],["eventList",""],["emptyState",""],[2,"display","flex","align-items","center","justify-content","center","margin","300px 0"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","past-body",4,"ngIf","ngIfElse"],["id","past-body"],[3,"ngClass","eventInfo","click",4,"ngFor","ngForOf"],[3,"ngClass","eventInfo","click"],[3,"emptyMessage"]],template:function(t,s){if(1&t&&(e.YNc(0,N,4,0,"div",0),e.YNc(1,K,1,2,"ng-template",null,1,e.W1O),e.YNc(3,R,2,2,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.isFetchingEvents)("ngIfElse",o)}},directives:[r.O5,r.sg,_,r.mk,f],styles:["#past-body[_ngcontent-%COMP%]{display:none;padding:32px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:24px;margin-top:200px}#past-body[_ngcontent-%COMP%]:not(:empty){display:grid;grid-gap:2rem 1.25rem;gap:2rem 1.25rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}#past-body[_ngcontent-%COMP%]:not(:empty) + .empty-state[_ngcontent-%COMP%]{display:none}"]}),n})();var B=c(8576);function G(n,i){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3,"Loading..."),e.qZA(),e.qZA(),e.qZA())}const X=function(n,i){return{selected:n,updated:i}};function ee(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-event-card-view",9),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).openDetailsPane(a.event_uuid)}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.WLB(2,X,s.selectedEventCard==t.event_uuid,s.checkIfEventUpdated(t)))("eventInfo",t)}}function te(n,i){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,ee,1,5,"app-event-card-view",8),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.upcomingEvents)}}function ne(n,i){if(1&n&&e.YNc(0,te,2,1,"div",6),2&n){const t=e.oxw(),s=e.MAs(4);e.Q6J("ngIf",!t.isFetchingEvents&&t.upcomingEvents.length>0)("ngIfElse",s)}}const ie=function(){return{title:"No events yet...",message:"Click the button at the side navigation bar to create an event"}};function oe(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"app-empty-state",10),e.qZA()),2&n&&(e.xp6(1),e.Q6J("emptyMessage",e.DdM(1,ie)))}const ae=[{path:"",component:D,children:[{path:"ongoing",component:Q},{path:"upcoming",component:(()=>{class n{constructor(t,s,o){this.userService=t,this.dataService=s,this.detailsPaneService=o,this.crypto=new B.w,this.searchText="",this.upcomingEvents=[],this.isFetchingEvents=!0,this.detailsPaneService.detailsPaneInfoChange.subscribe(a=>{this.selectedEventCard=a.dpEventUUID})}ngOnInit(){this.fetchUpcomingEvents(),setTimeout(()=>sessionStorage.removeItem("updatedEventUUID"),5e3)}fetchUpcomingEvents(){var t=this;const s=new v.K;s.EndPoint="/events/upcoming",s.requestType=5,s.authToken=this.userService.HttpOptions,this.dataService.httpRequest(s).subscribe(function(){var o=(0,d.Z)(function*(a){yield t.setOngoingEvents(a),yield console.log(t.upcomingEvents),t.isFetchingEvents=!1,t.sortEvents()});return function(a){return o.apply(this,arguments)}}(),function(){var o=(0,d.Z)(function*(a){"Unauthorized"==a.statusText?(t.userService.refreshAccessToken(),t.userService.start()):(t.dataService.handleError(a),t.isFetchingEvents=!1)});return function(a){return o.apply(this,arguments)}}())}setOngoingEvents(t){this.upcomingEvents=t}sortEvents(){this.upcomingEvents.sort((t,s)=>new Date(t.event_start_date.split("[")[0]).valueOf()-new Date(s.event_start_date.split("[")[0]).valueOf())}openDetailsPane(t){this.detailsPaneService.showDetailsPane(t)}checkIfEventUpdated(t){return sessionStorage.getItem("updatedEventUUID")==t.event_uuid}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.K),e.Y36(m.D),e.Y36(u))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-upcoming"]],decls:5,vars:2,consts:[["style","display: flex; align-items: center; justify-content: center; margin: 300px 0;",4,"ngIf","ngIfElse"],["eventList",""],["emptyState",""],[2,"display","flex","align-items","center","justify-content","center","margin","300px 0"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","upcoming-body",4,"ngIf","ngIfElse"],["id","upcoming-body"],[3,"ngClass","eventInfo","click",4,"ngFor","ngForOf"],[3,"ngClass","eventInfo","click"],[3,"emptyMessage"]],template:function(t,s){if(1&t&&(e.YNc(0,G,4,0,"div",0),e.YNc(1,ne,1,2,"ng-template",null,1,e.W1O),e.YNc(3,oe,2,2,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.isFetchingEvents)("ngIfElse",o)}},directives:[r.O5,r.sg,_,r.mk,f],styles:["#upcoming-body[_ngcontent-%COMP%]{display:none;padding:32px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:24px;margin-top:200px}#upcoming-body[_ngcontent-%COMP%]:not(:empty){display:grid;grid-gap:2rem 1.25rem;gap:2rem 1.25rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}#upcoming-body[_ngcontent-%COMP%]:not(:empty) + .empty-state[_ngcontent-%COMP%]{display:none}"]}),n})()},{path:"past",component:W}]}];let re=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.Bz.forChild(ae)],g.Bz]}),n})();var ce=c(4466);let pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[r.ez,re,ce.m]]}),n})()}}]);