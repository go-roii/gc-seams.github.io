"use strict";(self.webpackChunkGCSEAMS=self.webpackChunkGCSEAMS||[]).push([[876],{5876:(ge,E,c)=>{c.r(E),c.d(E,{EventsModule:()=>ve});var a=c(9808),v=c(8118),e=c(1223),g=c(5861),C=c(7579),d=c(2033),l=c(4012),u=c(555),m=c(968);let _=(()=>{class n{constructor(t,s){this.userService=t,this.dataService=s,this.detailsPaneInfoChange=new C.x,this.eventProgressChange=new C.x}get dpEventStartDate(){const t=this.eventInfo.event_start_date.split("[")[0].toString();return new Date(t)}get dpEventEndDate(){const t=this.eventInfo.event_end_date.split("[")[0].toString();return new Date(t)}get dpCurrentEventProgress(){let t=new Date;if(t>=this.dpEventEndDate)return 100;if(t>=this.dpEventStartDate){const s=(this.dpEventEndDate.getTime()-this.dpEventStartDate.getTime())/6e4;return Math.trunc(Math.round((t.getTime()-this.dpEventStartDate.getTime())/6e4)/s*100)}return 0}initializeDetailsPane(t){this.detailsPane=t,this.bsDetailsPane=new bootstrap.Offcanvas(this.detailsPane),this.detailsPane.addEventListener("hidden.bs.offcanvas",()=>{this.detailsPaneInfoChange.next({isDetailsPaneShown:!1,selectedEventCard:void 0,dpEventID:0,dpEventUUID:"",dpEventPosterLink:"",dpEventTitle:"",dpEventStartDate:void 0,dpEventEndDate:void 0,dpCurrentEventProgress:0,dpEventDescription:"",dpEventInvitedDepartments:[],dpEventSpeakers:[]})})}showDetailsPane(t){var s=this;const o=new d.K;o.EndPoint=`event/${t}`,o.RequestType=l.l.GET_REQUIRES_AUTHENTICATION,o.AuthToken=this.userService.HttpOptions,this.dataService.httpRequest(o).subscribe(function(){var r=(0,g.Z)(function*(p){s.eventInfo=p,s.detailsPaneInfoChange.next({isDetailsPaneShown:!0,selectedEventCard:p.event_id,dpEventUUID:t,dpEventPosterLink:p.event_poster_link,dpEventTitle:p.event_title,dpEventStartDate:s.dpEventStartDate,dpEventEndDate:s.dpEventEndDate,dpCurrentEventProgress:s.dpCurrentEventProgress,dpEventDescription:p.event_description,dpEventInvitedDepartments:p.departments,dpEventSpeakers:p.speakers}),s.bsDetailsPane.show()});return function(p){return r.apply(this,arguments)}}())}updateEventProgress(){this.eventProgressChange.next(this.dpCurrentEventProgress)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(u.K),e.LFG(m.D))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var P=c(7899);const x=["detailsPane"];function T(n,i){1&n&&(e.O4$(),e.TgZ(0,"svg",30),e._UZ(1,"rect",31),e.qZA())}function b(n,i){if(1&n&&e._UZ(0,"img",32),2&n){const t=e.oxw();e.s9C("src",t.dpEventPosterLink,e.LSH)}}function Z(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"span",33),e._uU(2),e.qZA(),e.BQk()),2&n){const t=i.$implicit;e.xp6(2),e.Oqu(t.department_code)}}function y(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"span",33),e._uU(2),e.qZA(),e.BQk()),2&n){const t=i.$implicit;e.xp6(2),e.Oqu(t.speaker_name)}}const O=function(n){return{"pe-none":n}},D=function(n){return{"progress-bar-animated progress-bar-striped":n}};let w=(()=>{class n{constructor(t){this.detailsPaneService=t,this.dpEventPosterLink=""}ngOnInit(){}ngAfterViewInit(){this.instantiateDetailsPane(),this.subscribeToDetailsPaneChange()}subscribeToDetailsPaneChange(){this.detailsPaneService.detailsPaneInfoChange.subscribe(t=>{this.isDetailsPaneShown=t.isDetailsPaneShown,this.dpEventUUID=t.dpEventUUID,this.dpEventTitle=t.dpEventTitle,this.dpEventStartDate=t.dpEventStartDate,this.dpEventEndDate=t.dpEventEndDate,this.dpCurrentEventProgress=t.dpCurrentEventProgress,this.dpEventDescription=t.dpEventDescription,this.dpEventSpeakers=t.dpEventSpeakers,this.dpEventPosterLink=t.dpEventPosterLink,this.dpEventInvitedDepartments=t.dpEventInvitedDepartments}),this.detailsPaneService.eventProgressChange.subscribe(t=>{this.dpCurrentEventProgress=t})}instantiateDetailsPane(){this.detailsPaneService.initializeDetailsPane(this.detailsPane.nativeElement)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(_))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-events"]],viewQuery:function(t,s){if(1&t&&e.Gf(x,5),2&t){let o;e.iGM(o=e.CRH())&&(s.detailsPane=o.first)}},decls:54,vars:30,consts:[["id","events-body"],[1,"gs-header"],[1,"tabs","user-select-none"],[1,"nav"],["data-bs-dismiss","offcanvas","data-bs-target","#details-pane",1,"nav-item"],["routerLink","ongoing","routerLinkActive","active",1,"nav-link"],[1,"active-tab-indicator"],["routerLink","upcoming","routerLinkActive","active",1,"nav-link"],["routerLink","past","routerLinkActive","active",1,"nav-link"],[2,"padding","16px 32px 32px"],["id","details-pane","data-bs-scroll","true","data-bs-backdrop","false","data-bs-keyboard","true","tabindex","-1",1,"offcanvas","offcanvas-end",2,"transition","none"],["detailsPane",""],[1,"offcanvas-header","p-4","pb-0"],["type","button","data-bs-dismiss","offcanvas",1,"btn-close","text-reset"],[1,"offcanvas-body","d-flex","flex-column","p-4"],["id","event-poster","data-bs-toggle","modal","data-bs-target","#viewFullEventPosterModal",1,"user-select-none","mb-4",3,"ngClass"],[1,"upload-event-poster-text","text-center"],["id","event-poster-img","style","aspect-ratio: 3/2;",4,"ngIf","ngIfElse"],["eventPoster",""],["id","dp-event-title",1,"text-break","mb-0"],["id","dp-event-datetime",1,"text-primary"],[1,"progress","mb-3"],["role","progressbar",1,"progress-bar","rounded-pill",3,"ngClass"],["id","dp-event-description"],[1,"mb-4",2,"display","flex","flex-wrap","wrap","gap","4px"],[4,"ngFor","ngForOf"],[2,"display","flex","flex-wrap","wrap","gap","4px"],[1,"d-grid","mt-auto","p-4"],["type","button",1,"btn","btn-lg","btn-primary","shadow",3,"routerLink"],[3,"eventPosterLink"],["id","event-poster-img",2,"aspect-ratio","3/2"],["width","100%","height","100%","fill","var(--bs-primary)"],["id","event-poster-img",3,"src"],[1,"badge","rounded-pill","bg-primary-glass","text-primary"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2"),e._uU(3,"My Events"),e.qZA(),e.qZA(),e.TgZ(4,"div",2),e.TgZ(5,"ul",3),e.TgZ(6,"li",4),e.TgZ(7,"a",5),e._uU(8,"Ongoing"),e.qZA(),e._UZ(9,"div",6),e.qZA(),e.TgZ(10,"li",4),e.TgZ(11,"a",7),e._uU(12,"Upcoming"),e.qZA(),e._UZ(13,"div",6),e.qZA(),e.TgZ(14,"li",4),e.TgZ(15,"a",8),e._uU(16,"Past"),e.qZA(),e._UZ(17,"div",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"div",9),e._UZ(19,"router-outlet"),e.qZA(),e.TgZ(20,"div",10,11),e.TgZ(22,"div",12),e._UZ(23,"button",13),e.qZA(),e.TgZ(24,"div",14),e.TgZ(25,"div",15),e.TgZ(26,"p",16),e._uU(27,"View full event poster"),e.qZA(),e.YNc(28,T,2,0,"svg",17),e.YNc(29,b,1,1,"ng-template",null,18,e.W1O),e.qZA(),e.TgZ(31,"h2",19),e._uU(32),e.qZA(),e.TgZ(33,"p",20),e._uU(34),e.ALo(35,"date"),e.ALo(36,"date"),e.ALo(37,"date"),e.qZA(),e.TgZ(38,"div",21),e._UZ(39,"div",22),e.qZA(),e.TgZ(40,"p",23),e._uU(41),e.qZA(),e.TgZ(42,"h6"),e._uU(43,"Invited Departments"),e.qZA(),e.TgZ(44,"div",24),e.YNc(45,Z,3,1,"ng-container",25),e.qZA(),e.TgZ(46,"h6"),e._uU(47,"Speakers"),e.qZA(),e.TgZ(48,"div",26),e.YNc(49,y,3,1,"ng-container",25),e.qZA(),e.qZA(),e.TgZ(50,"div",27),e.TgZ(51,"button",28),e._uU(52,"View Attendance"),e.qZA(),e.qZA(),e.qZA(),e._UZ(53,"app-view-photo-modal",29),e.qZA()),2&t){const o=e.MAs(30);e.Udp("margin-right",s.isDetailsPaneShown?"400px":"0"),e.xp6(25),e.Q6J("ngClass",e.VKq(26,O,0===s.dpEventPosterLink.length)),e.xp6(3),e.Q6J("ngIf",0===s.dpEventPosterLink.length)("ngIfElse",o),e.xp6(4),e.Oqu(s.dpEventTitle),e.xp6(2),e.lnq("",e.xi3(35,17,s.dpEventStartDate,"mediumDate")," - ",e.xi3(36,20,s.dpEventStartDate,"shortTime")," to ",e.xi3(37,23,s.dpEventEndDate,"shortTime"),""),e.xp6(5),e.Udp("width",s.dpCurrentEventProgress+"%"),e.Q6J("ngClass",e.VKq(28,D,s.dpCurrentEventProgress>0&&s.dpCurrentEventProgress<100)),e.xp6(2),e.Oqu(s.dpEventDescription),e.xp6(4),e.Q6J("ngForOf",s.dpEventInvitedDepartments),e.xp6(4),e.Q6J("ngForOf",s.dpEventSpeakers),e.xp6(2),e.Q6J("routerLink",s.dpEventUUID),e.xp6(2),e.Q6J("eventPosterLink",s.dpEventPosterLink)}},directives:[v.yS,v.Od,v.lC,a.mk,a.O5,a.sg,v.rH,P.m],pipes:[a.uU],styles:['#events-body[_ngcontent-%COMP%]{height:100%;overflow-y:scroll}.gs-header[_ngcontent-%COMP%]{margin-bottom:16px}.tabs[_ngcontent-%COMP%]{background-color:#fff;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none;padding:0 32px}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.tabs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{gap:24px;width:max-content}.tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--bs-gray-600);font-size:16px;padding:4px 6px 8px}.tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:unset;font-weight:500}.tabs[_ngcontent-%COMP%]   .active-tab-indicator[_ngcontent-%COMP%]{display:none;min-height:3px;background-color:var(--bs-primary);border-radius:99px 99px 0 0}.tabs[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%] + .active-tab-indicator[_ngcontent-%COMP%]{display:block}#event-poster[_ngcontent-%COMP%]{flex-shrink:0;position:relative;z-index:100;width:100%;border-radius:12px;overflow:hidden;cursor:pointer}#event-poster[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;transition:.3s cubic-bezier(.6,.05,.28,.91)}#event-poster[_ngcontent-%COMP%]:hover:before{background-color:#00000040}#event-poster[_ngcontent-%COMP%]:hover   .upload-event-poster-text[_ngcontent-%COMP%]{opacity:1}#event-poster-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.upload-event-poster-text[_ngcontent-%COMP%]{color:#fff;opacity:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transition:opacity .3s cubic-bezier(.6,.05,.28,.91)}.progress[_ngcontent-%COMP%]{height:4px;min-height:4px}']}),n})();function S(n,i){1&n&&(e.O4$(),e.TgZ(0,"svg",9),e._UZ(1,"rect",10),e._uU(2,"--\x3e "),e.qZA())}function I(n,i){if(1&n&&e._UZ(0,"img",11),2&n){const t=e.oxw();e.s9C("src",t.eventInfo.event_poster_link,e.LSH)}}const A=function(n){return["/home/events",n]},U=function(n){return{"progress-bar-animated progress-bar-striped":n}};let f=(()=>{class n{constructor(){}ngOnInit(){this.formatDate(),this.getEventProgress()}formatDate(){const t=this.eventInfo.event_start_date.split("[")[0].toString(),s=this.eventInfo.event_end_date.split("[")[0].toString();this.eventStartDate=new Date(t),this.eventEndDate=new Date(s)}getEventProgress(){let t=new Date;if(t>=this.eventEndDate)this.currentEventProgress=100;else if(t>=this.eventStartDate){const s=(this.eventEndDate.getTime()-this.eventStartDate.getTime())/6e4;this.currentEventProgress=Math.trunc(Math.round((t.getTime()-this.eventStartDate.getTime())/6e4)/s*100),console.log("event duration: "+s+"min"),console.log("event progress: "+this.currentEventProgress+"%")}else this.currentEventProgress=0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-event-card-view"]],inputs:{eventInfo:"eventInfo"},decls:15,vars:23,consts:[[1,"card","user-select-none"],[3,"routerLink","click"],["class","card-img-top",4,"ngIf","ngIfElse"],["eventPoster",""],[1,"card-body"],[1,"card-title"],[1,"card-subtitle","mb-3"],[1,"progress"],["role","progressbar",1,"progress-bar","rounded-pill",3,"ngClass"],[1,"card-img-top"],["width","100%","height","100%","fill","var(--bs-primary)"],[1,"card-img-top",3,"src"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"a",1),e.NdJ("click",function(r){return r.stopPropagation}),e.YNc(2,S,3,0,"svg",2),e.YNc(3,I,1,1,"ng-template",null,3,e.W1O),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"h5",5),e._uU(7),e.qZA(),e.TgZ(8,"p",6),e._uU(9),e.ALo(10,"date"),e.ALo(11,"date"),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"div",8),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.MAs(4);e.xp6(1),e.Q6J("routerLink",e.VKq(19,A,s.eventInfo.event_uuid)),e.xp6(1),e.Q6J("ngIf",0===s.eventInfo.event_poster_link.length)("ngIfElse",o),e.xp6(5),e.Oqu(s.eventInfo.event_title),e.xp6(2),e.lnq("",e.xi3(10,10,s.eventStartDate,"mediumDate")," - ",e.xi3(11,13,s.eventStartDate,"shortTime")," to ",e.xi3(12,16,s.eventEndDate,"shortTime"),""),e.xp6(5),e.Udp("width",s.currentEventProgress+"%"),e.Q6J("ngClass",e.VKq(21,U,s.currentEventProgress>0&&s.currentEventProgress<100))}},directives:[v.yS,a.O5,a.mk],pipes:[a.uU],styles:["[_nghost-%COMP%]{--card-aspect-ratio: 16/9}.selected[_nghost-%COMP%]   .card[_ngcontent-%COMP%], .selected   [_nghost-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid var(--bs-primary);box-shadow:0 0 6px rgb(var(--bs-primary-rgb),64%)}.updated[_nghost-%COMP%]   .card[_ngcontent-%COMP%], .updated   [_nghost-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid var(--bs-primary);box-shadow:0 0 6px rgb(var(--bs-primary-rgb),64%)}.card[_ngcontent-%COMP%]{aspect-ratio:var(--card-aspect-ratio)}.card-img-top[_ngcontent-%COMP%]{aspect-ratio:var(--card-aspect-ratio);object-fit:cover;background-color:var(--bs-gray-100)}.card-title[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:1;line-clamp:1;overflow:hidden;-webkit-box-orient:vertical}.card-subtitle[_ngcontent-%COMP%]{color:var(--bs-primary);font-size:14px}.progress[_ngcontent-%COMP%]{height:4px}"]}),n})();var h=c(2159);function k(n,i){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3,"Loading..."),e.qZA(),e.qZA(),e.qZA())}const M=function(n){return{selected:n}};function q(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-event-card-view",9),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).openDetailsPane(r.event_uuid)}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,M,s.selectedEventCard==t.event_uuid))("eventInfo",t)}}function F(n,i){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,q,1,4,"app-event-card-view",8),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.ongoingEvents)}}function L(n,i){if(1&n&&e.YNc(0,F,2,1,"div",6),2&n){const t=e.oxw(),s=e.MAs(4);e.Q6J("ngIf",!t.isFetchingEvents&&t.ongoingEvents.length>0)("ngIfElse",s)}}const Q=function(){return{title:"No events yet...",message:"Click the button at the side navigation bar to create an event"}};function Y(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"app-empty-state",10),e.qZA()),2&n&&(e.xp6(1),e.Q6J("message",e.DdM(1,Q)))}let J=(()=>{class n{constructor(t,s,o){this.userService=t,this.dataService=s,this.detailsPaneService=o,this.searchText="",this.ongoingEvents=[],this.isFetchingEvents=!0,this.detailsPaneService.detailsPaneInfoChange.subscribe(r=>{this.selectedEventCard=r.dpEventUUID})}ngOnInit(){this.fetchOngoingEvents(),this.updateEventsProgress()}ngOnDestroy(){clearInterval(this.updateEventsProgressInterval)}updateEventsProgress(){this.updateEventsProgressInterval=setInterval(()=>{var t;null===(t=this.EventCardViewComponents)||void 0===t||t.forEach(s=>{s.getEventProgress()}),this.detailsPaneService.bsDetailsPane._isShown&&this.detailsPaneService.updateEventProgress()},6e4)}fetchOngoingEvents(){var t=this;const s=new d.K;s.EndPoint="/events/ongoing",s.RequestType=l.l.GET_REQUIRES_AUTHENTICATION,s.AuthToken=this.userService.HttpOptions,this.dataService.httpRequest(s).subscribe(function(){var o=(0,g.Z)(function*(r){t.setOngoingEvents(r),console.log(t.ongoingEvents),t.isFetchingEvents=!1,t.sortEvents()});return function(r){return o.apply(this,arguments)}}(),function(){var o=(0,g.Z)(function*(r){"Unauthorized"==r.statusText?(t.userService.refreshAccessToken(),t.userService.start()):(t.dataService.handleError(r),t.isFetchingEvents=!1)});return function(r){return o.apply(this,arguments)}}())}setOngoingEvents(t){this.ongoingEvents=t}sortEvents(){this.ongoingEvents.sort((t,s)=>new Date(t.event_start_date.split("[")[0]).valueOf()-new Date(s.event_start_date.split("[")[0]).valueOf())}openDetailsPane(t){this.detailsPaneService.showDetailsPane(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.K),e.Y36(m.D),e.Y36(_))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ongoing"]],viewQuery:function(t,s){if(1&t&&e.Gf(f,5),2&t){let o;e.iGM(o=e.CRH())&&(s.EventCardViewComponents=o)}},decls:5,vars:2,consts:[["style","display: flex; align-items: center; justify-content: center; margin: 300px 0;",4,"ngIf","ngIfElse"],["eventList",""],["emptyState",""],[2,"display","flex","align-items","center","justify-content","center","margin","300px 0"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","ongoing-body",4,"ngIf","ngIfElse"],["id","ongoing-body"],[3,"ngClass","eventInfo","click",4,"ngFor","ngForOf"],[3,"ngClass","eventInfo","click"],[3,"message"]],template:function(t,s){if(1&t&&(e.YNc(0,k,4,0,"div",0),e.YNc(1,L,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Y,2,2,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.isFetchingEvents)("ngIfElse",o)}},directives:[a.O5,a.sg,f,a.mk,h.s],styles:["#ongoing-body[_ngcontent-%COMP%]{display:grid;grid-gap:2rem 1.25rem;gap:2rem 1.25rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}"]}),n})();function R(n,i){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3,"Loading..."),e.qZA(),e.qZA(),e.qZA())}const z=function(n){return{selected:n}};function V(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-event-card-view",9),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).openDetailsPane(r.event_uuid)}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.VKq(2,z,s.selectedEventCard==t.event_uuid))("eventInfo",t)}}function H(n,i){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,V,1,4,"app-event-card-view",8),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.pastEvents)}}function K(n,i){if(1&n&&e.YNc(0,H,2,1,"div",6),2&n){const t=e.oxw(),s=e.MAs(4);e.Q6J("ngIf",!t.isFetchingEvents&&t.pastEvents.length>0)("ngIfElse",s)}}const j=function(){return{title:"No events yet...",message:"Click the button at the side navigation bar to create an event"}};function $(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"app-empty-state",10),e.qZA()),2&n&&(e.xp6(1),e.Q6J("message",e.DdM(1,j)))}let W=(()=>{class n{constructor(t,s,o){this.userService=t,this.dataService=s,this.detailsPaneService=o,this.searchText="",this.pastEvents=[],this.isFetchingEvents=!0,this.detailsPaneService.detailsPaneInfoChange.subscribe(r=>{this.selectedEventCard=r.dpEventUUID})}ngOnInit(){this.fetchPastEvents()}fetchPastEvents(){var t=this;const s=new d.K;s.EndPoint="/events/past",s.RequestType=l.l.GET_REQUIRES_AUTHENTICATION,s.AuthToken=this.userService.HttpOptions,this.dataService.httpRequest(s).subscribe(function(){var o=(0,g.Z)(function*(r){t.setOngoingEvents(r),console.log(t.pastEvents),t.isFetchingEvents=!1,t.sortEvents()});return function(r){return o.apply(this,arguments)}}(),function(){var o=(0,g.Z)(function*(r){"Unauthorized"==r.statusText?(t.userService.refreshAccessToken(),t.userService.start()):(t.dataService.handleError(r),t.isFetchingEvents=!1)});return function(r){return o.apply(this,arguments)}}())}setOngoingEvents(t){this.pastEvents=t}sortEvents(){this.pastEvents.sort((t,s)=>new Date(s.event_start_date.split("[")[0]).valueOf()-new Date(t.event_start_date.split("[")[0]).valueOf())}openDetailsPane(t){this.detailsPaneService.showDetailsPane(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.K),e.Y36(m.D),e.Y36(_))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-past"]],decls:5,vars:2,consts:[["style","display: flex; align-items: center; justify-content: center; margin: 300px 0;",4,"ngIf","ngIfElse"],["eventList",""],["emptyState",""],[2,"display","flex","align-items","center","justify-content","center","margin","300px 0"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","past-body",4,"ngIf","ngIfElse"],["id","past-body"],[3,"ngClass","eventInfo","click",4,"ngFor","ngForOf"],[3,"ngClass","eventInfo","click"],[3,"message"]],template:function(t,s){if(1&t&&(e.YNc(0,R,4,0,"div",0),e.YNc(1,K,1,2,"ng-template",null,1,e.W1O),e.YNc(3,$,2,2,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.isFetchingEvents)("ngIfElse",o)}},directives:[a.O5,a.sg,f,a.mk,h.s],styles:["#past-body[_ngcontent-%COMP%]{display:grid;grid-gap:2rem 1.25rem;gap:2rem 1.25rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}"]}),n})();var B=c(8576);function X(n,i){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3,"Loading..."),e.qZA(),e.qZA(),e.qZA())}const ee=function(n,i){return{selected:n,updated:i}};function te(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-event-card-view",9),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).openDetailsPane(r.event_uuid)}),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Q6J("ngClass",e.WLB(2,ee,s.selectedEventCard==t.event_uuid,s.checkIfEventUpdated(t)))("eventInfo",t)}}function ne(n,i){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,te,1,5,"app-event-card-view",8),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.upcomingEvents)}}function se(n,i){if(1&n&&e.YNc(0,ne,2,1,"div",6),2&n){const t=e.oxw(),s=e.MAs(4);e.Q6J("ngIf",!t.isFetchingEvents&&t.upcomingEvents.length>0)("ngIfElse",s)}}const oe=function(){return{title:"No events yet...",message:"Click the button at the side navigation bar to create an event"}};function re(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"app-empty-state",10),e.qZA()),2&n&&(e.xp6(1),e.Q6J("message",e.DdM(1,oe)))}const ae=[{path:"",component:w,children:[{path:"ongoing",component:J},{path:"upcoming",component:(()=>{class n{constructor(t,s,o){this.userService=t,this.dataService=s,this.detailsPaneService=o,this.crypto=new B.w,this.searchText="",this.upcomingEvents=[],this.isFetchingEvents=!0,this.detailsPaneService.detailsPaneInfoChange.subscribe(r=>{this.selectedEventCard=r.dpEventUUID})}ngOnInit(){this.fetchUpcomingEvents(),setTimeout(()=>sessionStorage.removeItem("updatedEventUUID"),5e3)}fetchUpcomingEvents(){var t=this;const s=new d.K;s.EndPoint="/events/upcoming",s.RequestType=l.l.GET_REQUIRES_AUTHENTICATION,s.AuthToken=this.userService.HttpOptions,this.dataService.httpRequest(s).subscribe(function(){var o=(0,g.Z)(function*(r){yield t.setOngoingEvents(r),yield console.log(t.upcomingEvents),t.isFetchingEvents=!1,t.sortEvents()});return function(r){return o.apply(this,arguments)}}(),function(){var o=(0,g.Z)(function*(r){"Unauthorized"==r.statusText?(t.userService.refreshAccessToken(),t.userService.start()):(t.dataService.handleError(r),t.isFetchingEvents=!1)});return function(r){return o.apply(this,arguments)}}())}setOngoingEvents(t){this.upcomingEvents=t}sortEvents(){this.upcomingEvents.sort((t,s)=>new Date(t.event_start_date.split("[")[0]).valueOf()-new Date(s.event_start_date.split("[")[0]).valueOf())}openDetailsPane(t){this.detailsPaneService.showDetailsPane(t)}checkIfEventUpdated(t){return sessionStorage.getItem("updatedEventUUID")==t.event_uuid}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.K),e.Y36(m.D),e.Y36(_))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-upcoming"]],decls:5,vars:2,consts:[["style","display: flex; align-items: center; justify-content: center; margin: 300px 0;",4,"ngIf","ngIfElse"],["eventList",""],["emptyState",""],[2,"display","flex","align-items","center","justify-content","center","margin","300px 0"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","upcoming-body",4,"ngIf","ngIfElse"],["id","upcoming-body"],[3,"ngClass","eventInfo","click",4,"ngFor","ngForOf"],[3,"ngClass","eventInfo","click"],[3,"message"]],template:function(t,s){if(1&t&&(e.YNc(0,X,4,0,"div",0),e.YNc(1,se,1,2,"ng-template",null,1,e.W1O),e.YNc(3,re,2,2,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.isFetchingEvents)("ngIfElse",o)}},directives:[a.O5,a.sg,f,a.mk,h.s],styles:["#upcoming-body[_ngcontent-%COMP%]{display:grid;grid-gap:2rem 1.25rem;gap:2rem 1.25rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}"]}),n})()},{path:"past",component:W}]}];let ce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[v.Bz.forChild(ae)],v.Bz]}),n})();var pe=c(4466);let ve=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[a.ez,ce,pe.m]]}),n})()}}]);